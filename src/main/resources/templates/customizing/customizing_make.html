<!DOCTYPE html>
<html class="no-js" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Empty Page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Karla:400,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700" rel="stylesheet">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

  <!-- Custom Style -->
  <link rel="stylesheet" href="/css/style.css">

  <!-- Summernote CSS -->
  <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.16/dist/summernote.min.css" rel="stylesheet">

  <style>
    .modal {
      position: fixed;
      z-index: 1050;
      overflow: hidden;
      outline: 0;
    }

    .note-editor .modal-dialog {
      margin-top: 100px;
    }
  </style>
</head>
<body>

<header th:replace="include/top :: top"></header>

<div id="fh5co-page">
  <header>
    <div class="container">
      <div class="fh5co-navbar-brand">
        <h1 class="text-center"><a class="fh5co-logo" href="../index_main.html">Minimal</a></h1>
        <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
      </div>
    </div>
  </header>

  <div id="fh5co-intro-section">
    <div class="container">
      <div class="row">
        <div class="col-md-8 col-md-offset-2 text-center">
          <h2 class="intro-heading" th:text="${customizingInfoName}"></h2>
          <p><span>Placeholder content can go here</span></p>

          <!-- Summernote 에디터 -->
          <div class="post-form">

            <form action="/customizing/save" method="post" enctype="multipart/form-data">
              <input type="hidden" name="customizingInfoIdx" th:value="${customizingInfoIdx}"/>
              <h2 class="intro-heading" th:text="${userIdx}"></h2>
              <h2 class="intro-heading" th:text="${customizingInfoIdx}"></h2>

              <label>제목:</label>
              <input type="text" name="customizingTitle" class="form-control" required><br>

              <label>내용:</label>
              <textarea id="summernote" name="customizingContent"></textarea><br>

              <button type="submit">저장</button>
            </form>

          </div>

        </div>
      </div>
    </div>
  </div>

  <footer th:replace="include/bottom :: bottomFooter"></footer>
</div>

<!-- jQuery 먼저 로드 -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Bootstrap JS -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<!-- Summernote JS -->
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.16/dist/summernote.min.js"></script>

<script>
  $(document).ready(function() {
    $('#summernote').summernote({
      height: 800,
      lang: 'ko-KR',
      toolbar: [
        ['fontsize', ['fontsize']],
        ['style', ['bold', 'italic', 'underline', 'clear']],
        ['color', ['color']],
        ['table', ['table']],
        ['para', ['ul', 'ol', 'paragraph']],
        ['insert', ['hr']]
      ],
      fontNames: ['Arial', 'Comic Sans MS', '맑은 고딕', '궁서', '굴림체'],
      callbacks: {
        onImageUpload: function(files) {
          for (let file of files) {
            uploadImage(file);
          }
        }
      }
    });
  });

  // 서버로 이미지 업로드
  function uploadImage(file) {
    let formData = new FormData();
    formData.append("file", file);

    $.ajax({
      url: '/customizing/uploadImage',  // 서버로 전송될 URL
      type: 'POST',
      data: formData,
      processData: false,
      contentType: false,
      success: function(response) {
        // 업로드가 성공하면 이미지의 URL을 editor에 삽입
        $('#summernote').summernote('insertImage', response.url);
      },
      error: function() {
        alert("이미지 업로드에 실패했습니다.");
      }
    });
  }
</script>

</body>
</html>
